'use strict';

Nitro.module('popup-whatsapp-promoter', function() {
	this.init = () => {
		this.htmlPopup();
		this.closePopup();
		this.addTransition();
	};

	this.htmlPopup = () => {
		var $url = location.href;
		$('body').append(`
			<div class="popup-whats">
				<div class="popup-whats-container">
					<button class="popup-whats-container--close">
						<svg width="15" height="16" viewBox="0 0 15 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M9.37254 8.42517L14.6123 3.14402C14.8605 2.89387 15 2.5546 15 2.20084C15 1.84707 14.8605 1.5078 14.6123 1.25765C14.364 1.0075 14.0274 0.866943 13.6764 0.866943C13.3253 0.866943 12.9886 1.0075 12.7404 1.25765L7.5 6.53805L2.25949 1.25765C2.01127 1.0075 1.67466 0.866943 1.32362 0.866943C0.972577 0.866943 0.635878 1.0075 0.387655 1.25765C0.139432 1.5078 4.4463e-08 1.84707 0 2.20084C-4.44624e-08 2.5546 0.139432 2.89387 0.387655 3.14402L5.62737 8.42517L0.387655 13.7063C0.264748 13.8302 0.167232 13.9772 0.100715 14.1391C0.0341976 14.3009 2.2016e-08 14.4743 0 14.6495C-2.20153e-08 14.8247 0.0341976 14.9982 0.100715 15.16C0.167232 15.3218 0.264748 15.4689 0.387655 15.5927C0.510563 15.7166 0.656469 15.8148 0.817055 15.8819C0.977642 15.9489 1.1498 15.9834 1.32362 15.9834C1.49744 15.9834 1.6695 15.9489 1.83009 15.8819C1.99068 15.8148 2.13658 15.7166 2.25949 15.5927L7.5 10.3116L12.7404 15.5927C12.8633 15.7166 13.0092 15.8148 13.1698 15.8819C13.3304 15.9489 13.5026 15.9834 13.6764 15.9834C13.8502 15.9834 14.0223 15.9489 14.1829 15.8819C14.3434 15.8148 14.4893 15.7166 14.6123 15.5927C14.7352 15.4689 14.8327 15.3218 14.8992 15.16C14.9657 14.9982 15 14.8247 15 14.6495C15 14.4743 14.9657 14.3009 14.8992 14.1391C14.8327 13.9772 14.7352 13.8302 14.6123 13.7063L9.37254 8.42517Z" fill="#C2C2C2"/>
						</svg>
					</button>
					<h2>Dúvidas na hora de comprar?</h2>
					<p>Fale com um promotor da Consul, tire suas dúvidas e compre com toda segurança.</p>
					<a class="popup-whats-container--link" href="https://api.whatsapp.com/send?phone=554788292017&&text=Olá, vim do site Consul. Link: ${$url}" target="_blank">
						<svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path fill-rule="evenodd" clip-rule="evenodd" d="M15.3776 3.06903C13.686 1.36968 11.4342 0.433472 9.03819 0.433472C4.09901 0.433472 0.076379 4.46483 0.076379 9.42105C0.076379 11.0041 0.489392 12.5503 1.27298 13.9148L0 18.5732L4.75247 17.3221C6.06223 18.037 7.53606 18.4143 9.03536 18.4171H9.03819C13.9774 18.4171 18 14.3858 18 9.42956C18.0028 7.02663 17.0693 4.76839 15.3776 3.06903ZM9.03819 16.8994H9.03536C7.69731 16.8994 6.38755 16.5391 5.24469 15.8582L4.97312 15.6965L2.15276 16.4369L2.90523 13.6794L2.72701 13.3957C1.9802 12.207 1.58699 10.8339 1.58982 9.42105C1.58982 5.30174 4.93069 1.95126 9.04101 1.95126C11.0297 1.95126 12.9024 2.7286 14.3083 4.14142C15.7143 5.55424 16.4894 7.42949 16.4894 9.42673C16.4866 13.546 13.1429 16.8994 9.03819 16.8994ZM13.123 11.302C12.8996 11.1885 11.7991 10.6466 11.5926 10.57C11.3861 10.4963 11.239 10.4566 11.0891 10.6835C10.9392 10.9076 10.512 11.4155 10.3791 11.563C10.2489 11.7133 10.1188 11.7304 9.8925 11.6197C9.66902 11.5062 8.94766 11.2708 8.09052 10.5048C7.42574 9.90902 6.97595 9.17424 6.84582 8.95011C6.7157 8.72599 6.84582 8.61535 6.94483 8.49052C7.18812 8.1898 7.4314 7.87206 7.50495 7.7217C7.5785 7.57134 7.54172 7.44083 7.48515 7.32736C7.42857 7.21388 6.98161 6.11029 6.79491 5.65921C6.61386 5.22231 6.42715 5.28189 6.29137 5.27338C6.16124 5.2677 6.01131 5.26486 5.86138 5.26486C5.71145 5.26486 5.46817 5.3216 5.2645 5.54573C5.05799 5.76985 4.4809 6.31455 4.4809 7.41814C4.4809 8.52173 5.2843 9.59127 5.39462 9.74163C5.50778 9.89199 6.97312 12.1587 9.21923 13.1318C9.75389 13.3645 10.1697 13.5006 10.495 13.6056C11.0325 13.7758 11.5191 13.7531 11.9066 13.6936C12.3366 13.6283 13.2305 13.1489 13.4173 12.6269C13.604 12.102 13.604 11.6538 13.5474 11.5601C13.4965 11.4722 13.3465 11.4155 13.123 11.302Z" fill="#736C6B"/>
						</svg>
						Fale com um promotor
					</a>
				</div>
			</div>
		`);
	};

	this.addTransition = () => {
		setTimeout(function() {
			$('.popup-whats').addClass('is--add ');
		}, 2000)
	};

	this.closePopup = () => {
		$('body').on('click', '.popup-whats-container--close', () => {
			$('.popup-whats').removeClass('is--add ');
			$('.popup-whats').addClass('is--remove');
		});
	};

	this.init();
});
